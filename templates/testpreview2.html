<!DOCTYPE html>
<html>
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-166946770-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-166946770-1');
</script>

  <title>بطاقات معايدة</title>
  
       <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css?family=Muli:300,400,500,600,700,800,900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Almarai:wght@700;800&family=Amiri&display=swap" rel="stylesheet">

<link href="https://fonts.googleapis.com/css2?family=Almarai:wght@400;700;800&family=Amiri&display=swap" rel="stylesheet">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
    <meta name="referrer" content="origin-when-cross-origin">

  <!--[if gte IE 7]><!-->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
  <!-- CSS only -->

<!-- JS, Popper.js, and jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script type="text/javascript" src="static/js/canvas2image.js"></script>
<style type="text/css">

  .center-block {
  display: block;
  margin-right: auto;
  margin-left: auto;
}
canvas {
    padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
    display: block;
     width: 100%;
}
a {
    color: #0060B6;
    text-decoration: none;
}

a:hover {
    color:#00A0C6; 
    text-decoration:none; 
    cursor:pointer;  
}
</style>
</head>
<div class="site-section">
<div class="container">
<div class="row mb-5 ">
<div class="col-md-7 text-center mx-auto">
 
  <section class="py-5 text-center container"  >
 <a href="http://localhost:8080/"> 
    <div class="row py-lg-5">
      <div class="col-lg-6 col-md-8 mx-auto">
        <h1 class="fw-light"  style="font-family: 'Almarai', sans-serif;">بطــاقــات معـايــدة</h1>
        <p class="lead text-muted"  style="font-family: 'Almarai', sans-serif;">عيد الفطر 1442 هـ</p>
   
      </div>
    </div>
	  </a>
  </section>

<body>
   <div class="row">
 


    
   <div  id="preview"   >
                </div>
           

<form   method = "POST" enctype = "multipart/form-data" >
<br>
  
                  <input type="text" class="form-control" placeholder="الاسم"  id="text"  name="username"  aria-label="Username" aria-describedby="basic-addon1">
        <input type="hidden"  name="color" value="one">
<br> <br>
  <!-- this the button to save the photo-->



                      <button id="save" type="submit" class="btn btn-outline-secondary btn-lg btn-block" >للتحميل</button>


 
    
    
  </form>


</div>
</body>
</div>

</div>
</div>

<footer class="text-muted py-5">
  <div class="container">
    <p class="float-end mb-1">
      <a href="#">عد إلى الأعلى</a>
    </p>
	<br>
    <p class="mb-1">مصممة الموقع <a href="https://twitter.com/@_45775"> هنا </a></p>
    <p class="mb-0"> مصممة البطاقات <a href="https://twitter.com/@MaramAlabbad"> هنا </a></p>
  </div>
</footer>
</div>
</div>


  <script defer >
var canvas = document.createElement('canvas');
ctx = canvas.getContext('2d');
var img2 = new Image();
img2.src = {{.Img}};

canvas.width  = img2.width;
canvas.height = img2.height;
document.getElementById("preview").appendChild(canvas);
function sendToCanvas( ob ){
  var img = new Image();
  img2.addEventListener('load', function(){
    ctx.drawImage(img2, 0, 0);
    ctx.font = ob.fontWeight+' '+ob.fontSize+' '+ob.{{.Fonts}}; //fontFamily
    ctx.textAlign = 'center';
    ctx.fillStyle = ob.color;
    ctx.fillText(ob.text, img2.width/2+{{.TextWidth}}, img2.height-{{.TextHight}});
  });
  img2.src = ob.image;
}

// Defaults
var cvsObj = {
    text       : "اسمك هنا",
    image      : {{ .Img }},
    fontFamily :  "Times",
   fontWeight : "normal",
    fontSize   : {{ .Size }},
    color      : {{ .Colors }}
};
//console.log("test");

sendToCanvas( cvsObj ); // Send default data on init
document.getElementById("text").addEventListener("input", function(){
  cvsObj.text = this.value; // Modify cvsObj text
  sendToCanvas( cvsObj );   // Send custom data on input

});





let btnDownload = document.querySelector('button');
let img = document.querySelector('img');
 
 
// Must use FileSaver.js 2.0.2 because 2.0.3 has issues.
btnDownload.addEventListener('click', () => {
    let imagePath = img.getAttribute('src');
    let fileName = getFileName(imagePath);
    saveAs(imagePath, fileName);
});
 
function getFileName(str) {
    return str.substring(str.lastIndexOf('/') + 1)
}


var   $save
$save = document.getElementById('save');
        $save.onclick = function (e) {
                w =img2.width,
                h = img2.height;
            Canvas2Image.saveAsImage(canvas, w, h, "png");
        }


 
</script>
   


</html>